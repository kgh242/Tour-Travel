<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.travel.pack.mapper.PackMapper">

    <insert id="packAdd" parameterType="com.travel.pack.dto.PackDTO">
		INSERT INTO pack_info (
			company_id, 
			pack_info_title,
			pack_info_country, 
			pack_info_safe, 
			pack_info_air, 
			pack_info_start_date, 
			pack_info_end_date, 
			pack_info_course, 
			pack_info_person_number, 
			pack_info_closing_date, 
			pack_info_sale, 
			pack_info_apply_date)
		 VALUES (
		 	#{company_id}, 
		 	#{pack_info_title},
		 	#{pack_info_country}, 
		 	#{pack_info_safe}, 
		 	#{pack_info_air}, 
		 	#{pack_info_start_date}, 
		 	#{pack_info_end_date}, 
		 	#{pack_info_course}, 
		 	#{pack_info_person_number}, 
		 	#{pack_info_closing_date}, 
		 	#{pack_info_sale}, 
		 	now());
		 	<selectKey resultType="integer" keyProperty="pack_info_no" order="AFTER">
   				SELECT LAST_INSERT_ID()
			</selectKey>
		 	
    </insert>
    
    <insert id="packHotelAdd" parameterType="com.travel.pack.dto.PackHotelDTO">
    	INSERT INTO pack_hotel (
    		pack_info_no,
    		pack_hotel_start_date,
    		pack_hotel_end_date,
    		pack_hotel_day,
    		hotel_code,
    		pack_hotel_name)
    	VALUES (
    		#{pack_info_no},
    		#{pack_hotel_start_date},
    		#{pack_hotel_end_date},
    		'0',
    		'가상호텔코드쿼리수정',
    		#{pack_hotel_name}
    		)
    </insert>
    
    <insert id="packScheduleAdd" parameterType="com.travel.pack.dto.PackScheduleDTO">
    	INSERT INTO pack_schedule (
    		pack_info_no,
    		company_id,
    		pack_schedule_date,
    		pack_schedule_contents)
    	VALUES (
  			#{pack_info_no},
    		#{company_id},
    		#{pack_schedule_date},
    		#{pack_schedule_contents}
    		)
    </insert>

    <insert id="packLandmarkAdd" parameterType="com.travel.pack.dto.PackLandmarkDTO">
    	INSERT INTO pack_landmark (
    		pack_info_no,
    		company_id,
    		pack_landmark_code,
    		pack_tour_date,
    		pack_tour_contents)
    	VALUES (
  			#{pack_info_no},
    		#{company_id},
    		#{pack_landmark_code},
    		#{pack_tour_date},
    		#{pack_tour_contents}
    		)
    </insert>
    
    
    <insert id="packHotelImgAdd" parameterType="map">
    	INSERT INTO pack_hotel_img (
    		pack_info_no, 
    		pack_hotel_img_path, 
    		pack_hotel_img_true_name, 
    		pack_hotel_img_false_name, 
    		pack_hotel_img_ext, 
    		pack_hotel_img_size, 
    		pack_hotel_img_date)
    	VALUES (    		
    		#{pack_info_no}, 
    		#{imgDTO.imgPath}, 
    		#{imgDTO.imgTrueName}, 
    		#{imgDTO.imgFalseName}, 
    		#{imgDTO.imgExt}, 
    		#{imgDTO.imgSize}, 
    		now())
    </insert>
    
   	<insert id="packScheduleImgAdd" parameterType="map">
    	INSERT INTO pack_schedule_img (
    		pack_info_no, 
    		pack_schedule_img_path, 
    		pack_schedule_img_true_name, 
    		pack_schedule_img_false_name, 
    		pack_schedule_img_ext, 
    		pack_schedule_img_size, 
    		pack_schedule_img_date)
    	VALUES (    		
    		#{pack_info_no}, 
    		#{imgDTO.imgPath}, 
    		#{imgDTO.imgTrueName}, 
    		#{imgDTO.imgFalseName}, 
    		#{imgDTO.imgExt}, 
    		#{imgDTO.imgSize}, 
    		now())
    </insert>
    
    <insert id="packLandmarkImgAdd" parameterType="map">
    	INSERT INTO pack_landmark_img (
    		pack_info_no, 
    		pack_tour_img_path, 
    		pack_tour_img_true_name, 
    		pack_tour_img_false_name, 
    		pack_tour_img_ext, 
    		pack_tour_img_size, 
    		pack_tour_img_date)
    	VALUES (    		
    		#{pack_info_no}, 
    		#{imgDTO.imgPath}, 
    		#{imgDTO.imgTrueName}, 
    		#{imgDTO.imgFalseName}, 
    		#{imgDTO.imgExt}, 
    		#{imgDTO.imgSize}, 
    		now())
    </insert>
	
	<insert id="packBeforeNotice" parameterType="Map">
		INSERT INTO pack_notice_before (
			pack_info_no,
			pack_notice_before_contents)
		VALUES (
			#{pack_info_no},
			#{pack_notice_before_contents}
		)
	</insert>
	
   	<insert id="packAfterNotice" parameterType="Map">
   		INSERT INTO pack_notice_after (
			pack_info_no,
			pack_notice_after_contents)
		VALUES (
			#{pack_info_no},
			#{pack_notice_after_contents}
		)
	</insert>
	
	<insert id="packPriceInfo" parameterType="com.travel.pack.dto.PackPriceDTO">
		INSERT INTO pack_price (
			pack_info_no,
			pack_price_adult,
			pack_price_child,
			pack_price_baby
			)
		VALUES (
			#{pack_info_no},
			#{pack_price_adult},
			#{pack_price_child},
			#{pack_price_baby}
			)
	</insert>

	<select id="packDeleteBookConfirmSelect" parameterType="int" resultType="int">
		SELECT COUNT(pack_book_no) FROM pack_book WHERE pack_info_no=#{pack_info_no}
	</select>
	
	<select id="packDeletePayConfirmSelect" parameterType="int" resultType="int">
		SELECT COUNT(pack_pay_no) FROM pack_pay WHERE pack_book_no=#{pack_info_no}
	</select>

    <select id="packGetPackInfo" parameterType="int" resultType="com.travel.pack.dto.PackDTO">
    	SELECT * FROM pack_info WHERE pack_info_no = #{pack_info_no}
    </select>
    
    <select id="packGetHotelInfo" parameterType="int" resultType="com.travel.pack.dto.PackHotelDTO">
    	SELECT * FROM pack_hotel WHERE pack_info_no = #{pack_info_no}
    </select>
    
    <select id="packGetLandmarkInfo" parameterType="int" resultType="com.travel.pack.dto.PackLandmarkDTO">
    	SELECT * FROM pack_landmark WHERE pack_info_no = #{pack_info_no}
    </select>
    
    <select id="packGetScheduleInfo" parameterType="int" resultType="com.travel.pack.dto.PackScheduleDTO">
    	SELECT * FROM pack_schedule WHERE pack_info_no = #{pack_info_no}
    </select>
    
    <select id="packGetPriceInfo" parameterType="int" resultType="com.travel.pack.dto.PackPriceDTO">
    	SELECT * FROM pack_price WHERE pack_info_no = #{pack_info_no}
    </select>
    
    <select id="packGetBeforeNoticeInfo" parameterType="int" resultType="String">
    	SELECT pack_notice_before_contents FROM pack_notice_before WHERE pack_info_no = #{pack_info_no}
    </select>
    
    <select id="packGetAfterNoticeInfo" parameterType="int" resultType="String">
    	SELECT pack_notice_after_contents FROM pack_notice_after WHERE pack_info_no = #{pack_info_no}
    </select>
    
    <select id="packHotelImgConfirmSelect" parameterType="int" resultType="com.travel.image.ImgDTO">
    	SELECT 
    		pack_hotel_img_path AS imgPath, 
    		pack_hotel_img_true_name AS imgTrueName, 
    		pack_hotel_img_false_name AS imgFalseName, 
    		pack_hotel_img_ext as imgExt 
    	FROM pack_hotel_img WHERE pack_info_no=#{pack_info_no}
    </select>
    
    <select id="packLandmarkImgConfirmSelect" parameterType="int" resultType="com.travel.image.ImgDTO">
        SELECT 
    		pack_tour_img_path AS imgPath, 
    		pack_tour_img_true_name AS imgTrueName, 
    		pack_tour_img_false_name AS imgFalseName, 
    		pack_tour_img_ext as imgExt 
    	FROM pack_landmark_img WHERE pack_info_no=#{pack_info_no}
    </select>
    
    <select id="packScheduleImgConfirmSelect" parameterType="int" resultType="com.travel.image.ImgDTO">
        SELECT 
    		pack_schedule_img_path AS imgPath, 
    		pack_schedule_img_true_name AS imgTrueName, 
    		pack_schedule_img_false_name AS imgFalseName, 
    		pack_schedule_img_ext as imgExt 
    	FROM pack_schedule_img WHERE pack_info_no=#{pack_info_no}
    </select>
    

    <select id="packList" resultType="com.travel.pack.dto.PackDTO">
    	SELECT * FROM pack_info
    </select>
    
    <delete id="packDelete" parameterType="int">
    	DELETE FROM pack_info WHERE pack_info_no = #{pack_info_no}
    </delete>

</mapper>